{
    "clusters": [{
        "nodes": [{
            "node": {
                "hostnames": {
                    "manage": "ip-172-20-122-137.eu-west-1.compute.internal",
                    "storage": ["172.20.122.137"]
                },
                "zone": 1
            },
            "devices": ["/dev/vdb", "/dev/vdc", "/dev/vdd"]
        } {
            "node": {
                "hostnames": {
                    "manage": "ip-172-20-47-48.eu-west-1.compute.internal",
                    "storage": ["172.20.47.48"]
                },
                "zone": 1
            },
            "devices": ["/dev/vdb", "/dev/vdc", "/dev/vdd"]
        } {
            "node": {
                "hostnames": {
                    "manage": "ip-172-20-95-172.eu-west-1.compute.internal",
                    "storage": ["172.20.95.172"]
                },
                "zone": 1
            },
            "devices": ["/dev/vdb", "/dev/vdc", "/dev/vdd"]
        } {
            "node": {
                "hostnames": {
                    "manage": "",
                    "storage": [""]
                },
                "zone": 1
            },
            "devices": ["/dev/vdb", "/dev/vdc", "/dev/vdd"]
        }]
    }]
}

{
  "clusters": [
    {
    {% for host in groups['node'] %}
      "nodes": [
        {
          "node": {
            "hostnames": {
              "manage": [
                "gluster23.rhs"
              ],
              "storage": [
                "192.168.1.200"
              ]
            },
            "zone": 1
          },
          "devices": [
            "/dev/sde",
            "/dev/sdf"
          ]
        },
    {% end_for %}
      ]
    }
  ]
}

start = "{\"clusters\":[{\"nodes\":["
end = "]}]}"
for i in is
do
    "{\"node\":{\"hostnames\":{\"manage\":\"${NODE}\",\"storage\":[\"${STORAGE_IP_ADDRESS}\"]},\"zone\":1},\"devices\":[\"/dev/vdb\",\"/dev/vdc\",\"/dev/vdd\"]}"
done

